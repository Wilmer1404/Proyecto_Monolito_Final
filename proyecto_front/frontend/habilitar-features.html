<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Configuración Empresarial - UTPL</title>
    
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    
    <!-- Font Awesome -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    
    <style>
      body {
        background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 50%, #1a1a1a 100%);
        min-height: 100vh;
        color: #ffffff;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      }

      .config-card {
        background: rgba(255, 255, 255, 0.95) !important;
        backdrop-filter: blur(15px);
        border: 1px solid rgba(255, 255, 255, 0.2) !important;
        color: #1a1a1a !important;
        border-radius: 20px !important;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1) !important;
      }

      .card-header {
        background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%) !important;
        color: white !important;
        border-bottom: 2px solid rgba(255, 255, 255, 0.1) !important;
        border-radius: 20px 20px 0 0 !important;
        padding: 2rem !important;
      }

      .btn {
        border-radius: 12px !important;
        padding: 12px 24px !important;
        font-weight: 600 !important;
        transition: all 0.3s ease !important;
        border: none !important;
      }

      .btn-primary {
        background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%) !important;
        border-color: transparent !important;
        color: white !important;
        box-shadow: 0 4px 15px rgba(26, 26, 26, 0.2) !important;
      }

      .btn-primary:hover {
        background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%) !important;
        border-color: transparent !important;
        transform: translateY(-2px) !important;
        box-shadow: 0 8px 25px rgba(26, 26, 26, 0.3) !important;
      }

      .btn-success {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%) !important;
        border-color: transparent !important;
        color: white !important;
        box-shadow: 0 4px 15px rgba(40, 167, 69, 0.2) !important;
      }

      .btn-success:hover {
        background: linear-gradient(135deg, #20c997 0%, #28a745 100%) !important;
        border-color: transparent !important;
        transform: translateY(-2px) !important;
        box-shadow: 0 8px 25px rgba(40, 167, 69, 0.3) !important;
      }

      .btn-info {
        background: linear-gradient(135deg, #17a2b8 0%, #138496 100%) !important;
        border-color: transparent !important;
        color: white !important;
        box-shadow: 0 4px 15px rgba(23, 162, 184, 0.2) !important;
      }

      .btn-info:hover {
        background: linear-gradient(135deg, #138496 0%, #17a2b8 100%) !important;
        border-color: transparent !important;
        transform: translateY(-2px) !important;
        box-shadow: 0 8px 25px rgba(23, 162, 184, 0.3) !important;
      }

      .btn-warning {
        background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%) !important;
        border-color: transparent !important;
        color: #1a1a1a !important;
        font-weight: 600 !important;
        box-shadow: 0 4px 15px rgba(255, 193, 7, 0.2) !important;
      }

      .btn-warning:hover {
        background: linear-gradient(135deg, #fd7e14 0%, #ffc107 100%) !important;
        border-color: transparent !important;
        color: #1a1a1a !important;
        transform: translateY(-2px) !important;
        box-shadow: 0 8px 25px rgba(255, 193, 7, 0.3) !important;
      }

      .btn-outline-secondary {
        border: 2px solid #e9ecef !important;
        color: #6c757d !important;
        background: transparent !important;
        font-weight: 500 !important;
      }

      .btn-outline-secondary:hover {
        background: #6c757d !important;
        color: white !important;
        border-color: #6c757d !important;
        transform: translateY(-1px) !important;
      }

      .alert {
        border-radius: 15px !important;
        border: none !important;
        padding: 16px 20px !important;
        font-weight: 500 !important;
        margin-top: 15px !important;
      }

      .alert-success {
        background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%) !important;
        color: #155724 !important;
        border-left: 4px solid #28a745 !important;
        box-shadow: 0 4px 15px rgba(40, 167, 69, 0.1) !important;
      }

      .alert-danger {
        background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%) !important;
        color: #721c24 !important;
        border-left: 4px solid #dc3545 !important;
        box-shadow: 0 4px 15px rgba(220, 53, 69, 0.1) !important;
      }
    </style>
  </head>
  <body>
    <div class="container d-flex align-items-center justify-content-center min-vh-100 py-4">
      <div class="config-card card shadow-lg" style="max-width: 600px;">
        <div class="card-header text-center">
          <h4 class="mb-0">
            <i class="fas fa-cogs me-2"></i>
            Configuración Empresarial
          </h4>
        </div>
        <div class="card-body">
          <p class="text-muted mb-4">
            <i class="fas fa-info-circle me-2"></i>
            Activa las funcionalidades necesarias del sistema empresarial.
          </p>

          <div class="d-grid gap-3">
            <button
              class="btn btn-success"
              onclick="habilitarFeature('invitaciones')"
            >
              <i class="fas fa-user-plus me-2"></i>
              Habilitar Invitaciones
            </button>

            <button
              class="btn btn-info"
              onclick="habilitarFeature('suscripciones')"
            >
              <i class="fas fa-bell me-2"></i>
              Habilitar Suscripciones
            </button>

            <button
              class="btn btn-warning"
              onclick="habilitarFeature('solicitudes_edicion')"
            >
              <i class="fas fa-edit me-2"></i>
              Habilitar Solicitudes de Edición
            </button>

            <button class="btn btn-primary" onclick="habilitarTodas()">
              <i class="fas fa-check-double me-2"></i>
              Habilitar Todas las Funcionalidades
            </button>
          </div>

          <div id="resultados" class="mt-4"></div>

          <div class="mt-4">
            <a href="panel.html" class="btn btn-outline-secondary">
              <i class="fas fa-arrow-left me-2"></i>
              Volver al Panel Empresarial
            </a>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script>
      const API_URL = "http://localhost:8080/feature-flags";

      async function habilitarFeature(nombre) {
        const btn = event.target;
        const originalText = btn.innerHTML;

        try {
          btn.disabled = true;
          btn.innerHTML =
            '<span class="spinner-border spinner-border-sm me-2"></span>Habilitando...';

          const response = await fetch(`${API_URL}/${nombre}/habilitar`, {
            method: "POST",
          });

          if (response.ok) {
            mostrarResultado(
              `✅ Funcionalidad "${nombre}" habilitada correctamente`,
              "success"
            );
          } else {
            const error = await response.text();
            mostrarResultado(`❌ Error: ${error}`, "danger");
          }
        } catch (error) {
          mostrarResultado(`❌ Error de conexión: ${error.message}`, "danger");
        } finally {
          btn.disabled = false;
          btn.innerHTML = originalText;
        }
      }

      async function habilitarTodas() {
        const features = [
          "invitaciones",
          "suscripciones",
          "solicitudes_edicion",
        ];

        for (const feature of features) {
          await habilitarFeature(feature);
          await new Promise((resolve) => setTimeout(resolve, 500)); // Esperar 500ms entre cada una
        }
      }

      function mostrarResultado(mensaje, tipo) {
        const resultados = document.getElementById("resultados");
        const alert = document.createElement("div");
        alert.className = `alert alert-${tipo} alert-dismissible fade show`;
        alert.innerHTML = `
                ${mensaje}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
        resultados.appendChild(alert);

        // Auto-remover después de 5 segundos
        setTimeout(() => {
          if (alert.parentNode) {
            alert.remove();
          }
        }, 5000);
      }
    </script>
  </body>
</html>
